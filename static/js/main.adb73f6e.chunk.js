(this["webpackJsonptwitch-mtg-legacy-finder"]=this["webpackJsonptwitch-mtg-legacy-finder"]||[]).push([[0],{14:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),o=n(9),a=n.n(o),i=(n(14),n(2)),s=n.n(i),l=n(4),d=n(3),u=n(5),h={getStreams:function(){var e=Object(l.a)(s.a.mark((function e(t){var n,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.twitch.tv/helix/streams?game_id=2748&first=100",{method:"GET",headers:{Authorization:"Bearer ".concat(t),"client-id":"po7qw7qlnkajp4a5lf72h83x4dmzod"}});case 3:return n=e.sent,e.next=6,n.json();case 6:return c=e.sent,e.abrupt("return",c);case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),getNextPage:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var c,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.twitch.tv/helix/streams?game_id=2748&after=".concat(n),{method:"GET",headers:{Authorization:"Bearer ".concat(t),"client-id":"po7qw7qlnkajp4a5lf72h83x4dmzod"}});case 3:return c=e.sent,e.next=6,c.json();case 6:return r=e.sent,e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}()},f=n(0),g=function(e){var t=e.title,n=e.streamer,c=e.thumbnail.toString().replace("{width}","500").replace("{height}","250");return Object(f.jsxs)("div",{className:"card",children:[Object(f.jsx)("div",{className:"card-header",children:Object(f.jsx)("h1",{children:n})}),Object(f.jsxs)("div",{className:"card-body",children:[Object(f.jsx)("h2",{children:t}),Object(f.jsxs)("div",{className:"img-link-container",children:[Object(f.jsxs)("a",{target:"_blank",rel:"noreferrer",href:"https://twitch.tv/".concat(n),children:[Object(f.jsx)("img",{src:c,alt:"".concat(n,"'s stream thumbnail")}),Object(f.jsx)("span",{className:"tooltip","data-text":"click to open ".concat(n,"'s stream")})]}),Object(f.jsx)("div",{className:"spacer"}),Object(f.jsxs)("a",{className:"link-button",rel:"noreferrer",target:"_blank",href:"https://twitch.tv/".concat(n),children:["Go to ",n,"'s stream!"]})]})]})]})},j=function(e){var t=e.legacyStreams,n=e.token;return Object(f.jsx)("div",{id:"resp",children:(null===t||void 0===t?void 0:t.length)?null===t||void 0===t?void 0:t.map((function(e){return Object(f.jsx)(g,{title:e.title,streamer:e.user_name,thumbnail:e.thumbnail_url},e.id)})):Object(f.jsx)("p",{style:{textAlign:"center"},children:n?"No live streamers at the moment. Try again later, or switch to a different format":"Please login to view live streamers"})})};var b=function(){var e="https://id.twitch.tv/oauth2/authorize?client_id=".concat("po7qw7qlnkajp4a5lf72h83x4dmzod","&redirect_uri=").concat("https://cobypear.github.io/twitch-mtg-legacy-finder","&response_type=").concat("token","&scope=").concat("openid","&claims=").concat("","&force_verify=true"),t=Object(c.useState)([]),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)(),i=Object(u.a)(a,2),g=i[0],b=i[1],p=Object(c.useState)(JSON.parse(localStorage.getItem("closed"))||!1),m=Object(u.a)(p,2),v=m[0],w=m[1],O=Object(c.useState)(JSON.parse(localStorage.getItem("format"))||"legacy"),x=Object(u.a)(O,2),y=x[0],k=x[1],S=Object(c.useState)(JSON.parse(localStorage.getItem("access_token"))||""),N=Object(u.a)(S,2),C=N[0],_=N[1];Object(c.useEffect)((function(){var e,t=C||(null===(e=window.location.href.split("=")[1])||void 0===e?void 0:e.split("&")[0]);_(t),localStorage.setItem("access_token",JSON.stringify(t||""))}),[C]),Object(c.useEffect)((function(){if(C){var e=function(e){var t=null===e||void 0===e?void 0:e.filter((function(e){return e.title.toLowerCase().includes(y)})),n=Object(d.a)(new Set(t));o((function(e){return Object(d.a)(n)}))};Object(l.a)(s.a.mark((function t(){var n,c,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.getStreams(C);case 2:n=t.sent,c=n.data,r=n.pagination,b(null===r||void 0===r?void 0:r.cursor),localStorage.setItem("cursor",JSON.stringify(g)),e(c);case 8:case"end":return t.stop()}}),t)})))()}}),[C,y]),Object(c.useEffect)((function(){var e=function(e){var t=null===e||void 0===e?void 0:e.filter((function(e){return e.title.toLowerCase().includes(y)})),n=Object(d.a)(new Set(t));o((function(e){return e?[].concat(Object(d.a)(e),Object(d.a)(n)):Object(d.a)(n)}))},t=function(){var t=Object(l.a)(s.a.mark((function t(){var n,c,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!g){t.next=9;break}return t.next=3,h.getNextPage(C,g);case 3:n=t.sent,c=n.data,r=n.pagination,b(r.cursor?r.cursor:""),localStorage.setItem("cursor",JSON.stringify(g)),e(c);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=function(e,t,n){var c;return function(){var r=this,o=arguments,a=function(){c=null,n||e.apply(r,o)},i=n&&!c;clearTimeout(c),c=setTimeout(a,t),i&&e.apply(r,o)}}((function(){window.innerHeight+window.scrollY>=document.body.offsetHeight-100&&t()}),250);window.onscroll=n}),[g,C,y]);var I=function(){w(!v),localStorage.setItem("closed",!v)};return Object(f.jsxs)("div",{className:"main-container",id:"#top",children:[Object(f.jsxs)("div",{className:"row",children:[Object(f.jsxs)("button",{id:"filter-btn",onClick:function(){k("legacy"===y?"modern":"legacy"),localStorage.setItem("format",JSON.stringify("legacy"===y?"modern":"legacy"))},children:["switch to ","".concat("legacy"===y?"modern":"legacy")]}),Object(f.jsx)("a",{className:"link-button",id:"login",href:e,children:"Login"}),v&&Object(f.jsx)("button",{id:"show-message",onClick:I,children:"show message"})]}),!v&&Object(f.jsx)("div",{className:"row",children:Object(f.jsxs)("div",{className:"message",style:{display:v?"none":"inline-block"},children:[Object(f.jsx)("h1",{children:"Welcome to Twitch M:tG Legacy Finder"}),Object(f.jsx)("button",{onClick:I,children:"x"}),Object(f.jsx)("p",{children:"How does it work?"}),Object(f.jsxs)("p",{children:["1. Click Login to login to your Twitch account ",Object(f.jsx)("a",{href:"https://github.com/CobyPear/twitch-mtg-legacy-finder#question-why-do-i-need-to-login-to-twitch",id:"why",children:"Why do I need to do this?"})]}),Object(f.jsx)("p",{children:"2. Browse live Magic: the Gathering streamers currently playing the best (Legacy) format"}),Object(f.jsx)("a",{className:"link-button",href:e,children:"Login"})]})}),Object(f.jsx)("div",{id:"cards",children:r&&Object(f.jsx)(j,{legacyStreams:r,token:C})}),Object(f.jsx)("button",{id:"to-top",onClick:function(){return window.location="#"},children:"^"}),Object(f.jsx)("footer",{id:"footer",children:Object(f.jsxs)("span",{children:["\xa9 ",Object(f.jsx)("a",{href:"https://cobysher.dev",children:"Coby Sher"})," 2021"]})})]})},p=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,o=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),o(e),a(e)}))},m=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function v(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}a.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(b,{})}),document.getElementById("root")),p(),function(e){if("serviceWorker"in navigator){if(new URL("/twitch-mtg-legacy-finder",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/twitch-mtg-legacy-finder","/service-worker.js");m?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var c=n.headers.get("content-type");404===n.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):v(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):v(t,e)}))}}()}},[[17,1,2]]]);
//# sourceMappingURL=main.adb73f6e.chunk.js.map